<UserControl x:Class="AppCommander.W7_11.WPF.ExecutionSpeedControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

    <UserControl.Resources>
        <Style x:Key="SpeedLabelStyle" TargetType="TextBlock">
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Margin" Value="0,0,10,5"/>
        </Style>

        <Style x:Key="SliderStyle" TargetType="Slider">
            <Setter Property="Minimum" Value="0"/>
            <Setter Property="IsSnapToTickEnabled" Value="True"/>
            <Setter Property="TickPlacement" Value="BottomRight"/>
            <Setter Property="Margin" Value="0,0,0,10"/>
        </Style>

        <Style x:Key="AdvancedSliderStyle" TargetType="Slider">
            <Setter Property="Margin" Value="0,5,0,10"/>
            <Setter Property="Width" Value="200"/>
        </Style>
    </UserControl.Resources>

    <Border Background="White" BorderBrush="#CCCCCC" BorderThickness="1" CornerRadius="5" Padding="15">
        <StackPanel>
            <!-- Hlavný nadpis -->
            <TextBlock Text="Rýchlosť vykonávania príkazov" FontSize="16" FontWeight="Bold" Margin="0,0,0,15"/>

            <!-- Hlavný slider pre rýchlosť -->
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <TextBlock Grid.Row="0" Text="Základná rýchlosť:" Style="{StaticResource SpeedLabelStyle}"/>

                <Slider x:Name="speedSlider" 
                        Grid.Row="1"
                        Style="{StaticResource SliderStyle}"
                        Minimum="0" 
                        Maximum="5" 
                        Value="2"
                        TickFrequency="1"
                        ValueChanged="SpeedSlider_ValueChanged"/>

                <!-- OPRAVA: Namiesto HorizontalAlignment="SpaceBetween" -->
                <Grid Grid.Row="2" Margin="0,5,0,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <TextBlock Grid.Column="0" Text="Veľmi pomalá" FontSize="10" Foreground="Gray" HorizontalAlignment="Left"/>
                    <TextBlock Grid.Column="1" Text="Pomalá" FontSize="10" Foreground="Gray" HorizontalAlignment="Center"/>
                    <TextBlock Grid.Column="2" Text="Normálna" FontSize="10" Foreground="Gray" HorizontalAlignment="Center"/>
                    <TextBlock Grid.Column="3" Text="Rýchla" FontSize="10" Foreground="Gray" HorizontalAlignment="Center"/>
                    <TextBlock Grid.Column="4" Text="Veľmi rýchla" FontSize="10" Foreground="Gray" HorizontalAlignment="Center"/>
                    <TextBlock Grid.Column="5" Text="Vlastná" FontSize="10" Foreground="Gray" HorizontalAlignment="Right"/>
                </Grid>
            </Grid>

            <!-- Popisky rýchlostí -->
            <Grid Margin="0,10,0,15">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition/>
                    <ColumnDefinition/>
                </Grid.ColumnDefinitions>

                <TextBlock x:Name="speedLabel" 
                           Grid.Column="0"
                           Text="Štandardná rýchlosť pre väčšinu aplikácií" 
                           FontStyle="Italic" 
                           Foreground="DarkGray"/>

                <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Right">
                    <Button x:Name="testButton" Content="Test" Padding="10,5" Margin="5,0" Click="TestButton_Click" 
                                Style="{StaticResource SecondaryButton}" Width="55" />
                    <Button x:Name="resetButton" Content="Reset" Padding="10,5" Click="ResetButton_Click" 
                                Style="{StaticResource SecondaryButton}" />
                </StackPanel>
            </Grid>

            <!-- Výsledok testu -->
            <TextBlock x:Name="testResultLabel" 
                       Foreground="Blue" 
                       FontWeight="SemiBold" 
                       Margin="0,0,0,15" 
                       Visibility="Collapsed"/>

            <!-- Pokročilé možnosti -->
            <Expander x:Name="advancedExpander" Header="Pokročilé nastavenia" Margin="0,10,0,0">
                <StackPanel Margin="10">

                    <!-- Delay medzi príkazmi -->
                    <TextBlock Text="Pauza medzi príkazmi (ms):" Style="{StaticResource SpeedLabelStyle}"/>
                    <Grid Margin="0,0,0,15">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition/>
                            <ColumnDefinition Width="60"/>
                        </Grid.ColumnDefinitions>
                        <Slider x:Name="defaultDelaySlider"
                                Grid.Column="0"
                                Style="{StaticResource AdvancedSliderStyle}"
                                Minimum="50" 
                                Maximum="5000" 
                                Value="500"
                                ValueChanged="SpeedSlider_ValueChanged"/>
                        <TextBlock Grid.Column="1" 
                                   Text="{Binding ElementName=defaultDelaySlider, Path=Value, StringFormat='{}{0:F0}ms'}"
                                   VerticalAlignment="Center"/>
                    </Grid>

                    <!-- Čakanie na element -->
                    <TextBlock Text="Max. čakanie na element (ms):" Style="{StaticResource SpeedLabelStyle}"/>
                    <Grid Margin="0,0,0,15">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition/>
                            <ColumnDefinition Width="60"/>
                        </Grid.ColumnDefinitions>
                        <Slider x:Name="elementWaitSlider"
                                Grid.Column="0"
                                Style="{StaticResource AdvancedSliderStyle}"
                                Minimum="1000" 
                                Maximum="15000" 
                                Value="5000"
                                ValueChanged="SpeedSlider_ValueChanged"/>
                        <TextBlock Grid.Column="1" 
                                   Text="{Binding ElementName=elementWaitSlider, Path=Value, StringFormat='{}{0:F0}ms'}"
                                   VerticalAlignment="Center"/>
                    </Grid>

                    <!-- Čakanie na zmenu stavu -->
                    <TextBlock Text="Max. čakanie na zmenu stavu (ms):" Style="{StaticResource SpeedLabelStyle}"/>
                    <Grid Margin="0,0,0,15">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition/>
                            <ColumnDefinition Width="60"/>
                        </Grid.ColumnDefinitions>
                        <Slider x:Name="stateWaitSlider"
                                Grid.Column="0"
                                Style="{StaticResource AdvancedSliderStyle}"
                                Minimum="500" 
                                Maximum="10000" 
                                Value="3000"
                                ValueChanged="SpeedSlider_ValueChanged"/>
                        <TextBlock Grid.Column="1" 
                                   Text="{Binding ElementName=stateWaitSlider, Path=Value, StringFormat='{}{0:F0}ms'}"
                                   VerticalAlignment="Center"/>
                    </Grid>

                    <!-- Checkboxy pre ďalšie možnosti -->
                    <CheckBox x:Name="waitForCompletionCheckBox" 
                              Content="Čakať na dokončenie predchádzajúceho príkazu"
                              IsChecked="True"
                              Margin="0,5"
                              Checked="AdvancedCheckBox_Changed"
                              Unchecked="AdvancedCheckBox_Changed"/>

                    <CheckBox x:Name="adaptiveDelayCheckBox" 
                              Content="Automaticky prispôsobovať rýchlosť"
                              IsChecked="True"
                              Margin="0,5"
                              Checked="AdvancedCheckBox_Changed"
                              Unchecked="AdvancedCheckBox_Changed"/>

                    <CheckBox x:Name="stateVerificationCheckBox" 
                              Content="Overovať úspešnosť vykonania príkazov"
                              IsChecked="True"
                              Margin="0,5"
                              Checked="AdvancedCheckBox_Changed"
                              Unchecked="AdvancedCheckBox_Changed"/>

                    <!-- Informačný panel -->
                    <Border Background="#F0F8FF" BorderBrush="#ADD8E6" BorderThickness="1" CornerRadius="3" Padding="10" Margin="0,15,0,0">
                        <StackPanel>
                            <TextBlock Text="💡 Tipy pre optimálne nastavenie:" FontWeight="SemiBold" Margin="0,0,0,5"/>
                            <TextBlock TextWrapping="Wrap" FontSize="11" Foreground="DarkBlue">
                                <Run>• Pre pomalé aplikácie použite vyššie hodnoty</Run><LineBreak/>
                                <Run>• Adaptívna rýchlosť sa automaticky prispôsobí výkonu</Run><LineBreak/>
                                <Run>• Overovanie príkazov zvyšuje spoľahlivosť, ale spomaľuje vykonávanie</Run>
                            </TextBlock>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </Expander>

            <!-- Status panel -->
            <Grid Margin="0,15,0,0" Background="#FAFAFA" Height="30">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <TextBlock x:Name="statusLabel" 
                           Grid.Column="0"
                           Text="Pripravené na vykonávanie príkazov" 
                           VerticalAlignment="Center" 
                           Margin="10,0"
                           Foreground="DarkGreen"/>

                <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center" Margin="0,0,10,0">
                    <Ellipse x:Name="statusIndicator" 
                             Width="8" Height="8" 
                             Fill="Green" 
                             Margin="0,0,5,0"/>
                    <TextBlock x:Name="statusSpeedLabel" Text="Normálna" FontSize="10" Foreground="Gray"/>
                </StackPanel>
            </Grid>

        </StackPanel>
    </Border>
</UserControl>